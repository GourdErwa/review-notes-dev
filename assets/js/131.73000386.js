(window.webpackJsonp=window.webpackJsonp||[]).push([[131],{343:function(e,t,a){"use strict";a.r(t);var r=a(0),s=Object(r.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("blockquote",[a("p",[e._v("专栏原创出处："),a("a",{attrs:{href:"https://github.com/GourdErwa/review-notes/tree/master/language/java-jvm",target:"_blank",rel:"noopener noreferrer"}},[e._v("github-源笔记文件 "),a("OutboundLink")],1),e._v(" ，"),a("a",{attrs:{href:"https://github.com/GourdErwa/java-advanced/tree/master/java-jvm",target:"_blank",rel:"noopener noreferrer"}},[e._v("github-源码 "),a("OutboundLink")],1),e._v("，欢迎 Star，转载请附上原文出处链接和本声明。")])]),e._v(" "),a("p",[e._v("Java JVM-虚拟机专栏系列笔记，系统性学习可访问个人复盘笔记-技术博客 "),a("a",{attrs:{href:"https://review-notes.top/language/java-jvm/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Java JVM-虚拟机 "),a("OutboundLink")],1)]),e._v(" "),a("h2",{attrs:{id:"排查过程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#排查过程"}},[e._v("#")]),e._v(" 排查过程")]),e._v(" "),a("ul",[a("li",[e._v("执行 "),a("code",[e._v("jps -l")]),e._v(" 命令，定位高内存占用的 PID")])]),e._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("div",{staticClass:"highlight-lines"},[a("br"),a("div",{staticClass:"highlighted"},[e._v(" ")]),a("br")]),a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("jps -l\n1174 org.elasticsearch.bootstrap.Elasticsearch\n")])])]),a("ul",[a("li",[e._v("执行 "),a("code",[e._v("jmap -histo:live PID")]),e._v(" 命令查看存活对象")])]),e._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("jmap -histo:live 1174\n num     #instances         #bytes  class name (module)\n-------------------------------------------------------\n   1:          7570         503328  [B (java.base@11.0.2)\n   2:          6987         167688  java.lang.String (java.base@11.0.2)\n   3:          1224         150344  java.lang.Class (java.base@11.0.2)\n   4:          3825         122400  java.util.HashMap$Node (java.base@11.0.2)\n   \n... 更多内容未粘贴   \n")])])]),a("ul",[a("li",[e._v("执行 "),a("code",[e._v("jmap -dump:live,format=b,file=test.dump PID")]),e._v(" 将存活对象转换为 dump 文件进行离线分析")])]),e._v(" "),a("blockquote",[a("p",[e._v("dump 文件太大时请注意，为了保证 dump 的信息是可靠的，所以会暂停应用程序。对于 dump 文件分析推荐使用 "),a("a",{attrs:{href:"https://www.ej-technologies.com/products/jprofiler/overview.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("jprofiler"),a("OutboundLink")],1),e._v(" 工具进行分析。")])]),e._v(" "),a("blockquote",[a("p",[e._v("如果 jmap 添加了 :live 参数后，JVM 会先触发 gc，然后再统计信息。")])]),e._v(" "),a("h2",{attrs:{id:"扩展"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#扩展"}},[e._v("#")]),e._v(" 扩展")]),e._v(" "),a("p",[e._v("内存区域占用情况分析可使用 "),a("code",[e._v("jstat")]),e._v(" 命令进行分析")]),e._v(" "),a("p",[e._v("比如：执行 "),a("code",[e._v("jstat -gcutil -t -h 5 PID 500 10")]),e._v(" 查看各内存区域占用情况")]),e._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("jstat -gcutil -t -h 5 1174 500 10\nTimestamp         S0     S1     E      O      M     CCS    YGC     YGCT    FGC    FGCT     GCT\n         1138.7   0.00 100.00  25.00  22.32  94.42  85.09     29    0.064     4    0.067    0.131\n         1139.2   0.00 100.00  50.00  22.32  94.42  85.09     29    0.064     4    0.067    0.131\n         1139.8   0.00 100.00  50.00  22.32  94.42  85.09     29    0.064     4    0.067    0.131\n         1140.3   0.00 100.00  50.00  22.32  94.42  85.09     29    0.064     4    0.067    0.131\n         1140.8   0.00 100.00  50.00  22.32  94.42  85.09     29    0.064     4    0.067    0.131\nTimestamp         S0     S1     E      O      M     CCS    YGC     YGCT    FGC    FGCT     GCT\n         1141.3   0.00 100.00  50.00  22.32  94.42  85.09     29    0.064     4    0.067    0.131\n         1141.8   0.00 100.00  50.00  22.32  94.42  85.09     29    0.064     4    0.067    0.131\n         1142.3   0.00 100.00  50.00  22.32  94.42  85.09     29    0.064     4    0.067    0.131\n         1142.8   0.00 100.00  50.00  22.32  94.42  85.09     29    0.064     4    0.067    0.131\n         1143.3   0.00 100.00  50.00  22.32  94.42  85.09     29    0.064     4    0.067    0.131\n")])])]),a("h2",{attrs:{id:"说明"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#说明"}},[e._v("#")]),e._v(" 说明")]),e._v(" "),a("blockquote",[a("p",[e._v("更多 JDK 相关命令详细用法可参考  "),a("a",{attrs:{href:"https://blog.csdn.net/xiaohulunb/article/details/103887785",target:"_blank",rel:"noopener noreferrer"}},[e._v("Java JVM JDK13 诊断命令处理工具 jps,jstat,jinfo,jmap,jstack,jcmd"),a("OutboundLink")],1)])]),e._v(" "),a("p",[e._v("高 CPU 占用分析可参考本专栏《故障诊断-高 CPU 占用》")]),e._v(" "),a("p",[e._v("实际生产过程中我们可以使用 dump 文件进行分析，或者使用一些可视化故障处理工具")]),e._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://docs.oracle.com/javase/9/tools/jhsdb.htm",target:"_blank",rel:"noopener noreferrer"}},[e._v("jhsdb"),a("OutboundLink")],1)]),e._v(" "),a("li",[a("a",{attrs:{href:"http://openjdk.java.net/tools/svc/jconsole/",target:"_blank",rel:"noopener noreferrer"}},[e._v("jconsole"),a("OutboundLink")],1)]),e._v(" "),a("li",[a("a",{attrs:{href:"https://www.oracle.com/technetwork/java/javaseproducts/mission-control/java-mission-control-1998576.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Java Mission Control"),a("OutboundLink")],1)]),e._v(" "),a("li",[a("a",{attrs:{href:"https://www.ej-technologies.com/products/jprofiler/overview.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("jprofiler"),a("OutboundLink")],1)])])])}),[],!1,null,null,null);t.default=s.exports}}]);